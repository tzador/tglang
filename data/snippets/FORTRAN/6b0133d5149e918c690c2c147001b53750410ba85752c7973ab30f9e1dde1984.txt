PROGRAM GRADIENT
C
C     CALCULATES THE GRADIENT OF A FUNCTION USING CENTRAL DIFFERENCES
C
      IMPLICIT NONE
C
C     DECLARE VARIABLES
      INTEGER, PARAMETER :: P = 3 ! SET INTEGER P TO A CONSTANT VALUE OF 3
      REAL :: X, DX, F, GRAD(P)   ! DECLARE REAL VARIABLES X, DX, F, GRAD
      INTEGER :: I                 ! DECLARE INTEGER VARIABLE I
C
C     PROMPT FOR INPUT
      WRITE(*, *) 'PLEASE ENTER A VALUE FOR X:'
      READ(*, *) X                   ! READ IN VALUE FOR X FROM USER
C
C     SET VALUE OF DX
      DX = 1.E-6
C
C     CALCULATE FUNCTION VALUE AT X
      F = 2*X**2 + 3*X + 1
C
C     CALCULATE THE GRADIENT OF THE FUNCTION
      DO I = 1, P   ! START DO LOOP WITH INDEX I RUNNING FROM 1 TO P
        X = X - DX  ! CHANGE X BY A SMALL AMOUNT
C
C       CALCULATE FUNCTION VALUE AT NEW X
        GRAD(I) = (F - (2*X**2 + 3*X + 1)) / DX  ! USING CENTRAL DIFFERENCES
        X = X + DX  ! CHANGE X BACK TO ORIGINAL VALUE
      END DO
C
C     PRINT OUT THE GRADIENT
      WRITE(*, *) 'THE GRADIENT OF THE FUNCTION IS:'
      WRITE(*, *) GRAD   ! WRITE OUT THE GRADIENT ARRAY
C
      END PROGRAM GRADIENT