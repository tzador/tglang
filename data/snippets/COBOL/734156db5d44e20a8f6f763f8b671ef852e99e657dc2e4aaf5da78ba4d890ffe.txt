01 WS-EMPLOYEE-RECORD.
           05 EMPLOYEE-ID       PIC 9(6).
           05 EMPLOYEE-NAME     PIC X(20).
           05 EMPLOYEE-AGE      PIC S9(3).
           05 EMPLOYEE-ADDRESS  PIC X(30).
           05 EMPLOYEE-SALARY   PIC 9(7)V99.
           05 EMPLOYEE-STATUS   PIC X.
       01 WS-TOTAL-SALARY       PIC 9(9)V99.
       01 WS-EMPLOYEE-COUNT     PIC 9(4).
       01 WS-LOOP-COUNT         PIC 9(4).
       01 WS-EMPLOYEE-TABLE.
           05 WS-EMPLOYEE-ENTRY OCCURS 100 TIMES INDEXED BY INDEX.
              10 EMPLOYEE-ID       PIC 9(6).
              10 EMPLOYEE-NAME     PIC X(20).
              10 EMPLOYEE-AGE      PIC S9(3).
              10 EMPLOYEE-ADDRESS  PIC X(30).
              10 EMPLOYEE-SALARY   PIC 9(7)V99.
              10 EMPLOYEE-STATUS   PIC X.
       01 WS-TOTAL-SALARYS.
           05 WS-TOTALS-TABLE OCCURS 100 TIMES INDEXED BY INDEX-TOTAL.
              10 WS-TOTAL-SALARY-ENTRY REDEFINES WS-EMPLOYEE-ENTRY.
                 15 WS-SALARY-TOTAL    PIC 9(9)V99.
                 15 WS-STATUS-TOTAL    PIC 9(9)V99.
       01 WS-TOTALS-TOTAL-EMPLOYEE PIC X.
           88 STATS-EXCEEDED-SALARY VALUE "Y".
       01 WS-TOTALS-TOTAL-AGE PIC X.
           88 STATS-OLDER-EMPLOYEE VALUE "Y".

       PERFORM VARYING INDEX FROM 1 BY 1 UNTIL INDEX > WS-EMPLOYEE-COUNT
           IF EMPLOYEE-SALARY(INDEX) > 10000
               ADD EMPLOYEE-SALARY(INDEX) TO WS-TOTAL-SALARY
               MOVE "Y" TO EMPLOYEE-STATUS(INDEX)
           END-IF
       END-PERFORM

       MOVE 100 TO WS-EMPLOYEE-COUNT
       PERFORM VARYING INDEX FROM 1 BY 1 UNTIL INDEX > 100
           MOVE 90000 TO EMPLOYEE-SALARY(INDEX)
           IF INDEX < 50
               MOVE "N" TO EMPLOYEE-STATUS(INDEX)
           ELSE
               MOVE "Y" TO EMPLOYEE-STATUS(INDEX)
           END-IF
       END-PERFORM

       PERFORM VARYING INDEX FROM 1 BY 1 UNTIL INDEX > WS-EMPLOYEE-COUNT
           IF EMPLOYEE-AGE(INDEX) > 50
               ADD 1 TO WS-LOOP-COUNT
           END-IF
       END-PERFORM
       
       IF WS-LOOP-COUNT > WS-EMPLOYEE-COUNT / 2
           MOVE "Y" TO STATS-OLDER-EMPLOYEE
       END-IF

       IF WS-TOTAL-SALARY > 1250000
           MOVE "Y" TO STATS-EXCEEDED-SALARY
       END-IF

       MOVE ZERO TO INDEX-TOTAL
       PERFORM VARYING INDEX FROM 1 BY 1 UNTIL INDEX > WS-EMPLOYEE-COUNT
           IF EMPLOYEE-STATUS(INDEX) = "Y"
               ADD EMPLOYEE-SALARY(INDEX) TO WS-TOTAL-SALARYS(WS-TOTAL-SALARY-ENTRY(INDEX-TOTAL))
               ADD 1 TO INDEX-TOTAL
           END-IF
       END-PERFORM

       IF INDEX-TOTAL > 0
           DIVIDE WS-TOTAL-SALARY BY INDEX-TOTAL GIVING WS-TOTAL-SALARY
           ADD EMPLOYEE-SALARY(INDEX) TO WS-TOTAL-SALARY(WS-TOTAL-SALARY-ENTRY(INDEX-TOTAL))
       END-IF