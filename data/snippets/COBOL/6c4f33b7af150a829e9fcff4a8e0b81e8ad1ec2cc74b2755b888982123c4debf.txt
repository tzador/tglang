IDENTIFICATION DIVISION.
       PROGRAM-ID. CALC-SALARY.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INPUT-FILE ASSIGN TO "EMPLOYEE-INFO.DAT"
                              ORGANIZATION IS LINE SEQUENTIAL.

           SELECT OUTPUT-FILE ASSIGN TO "SALARY-REPORT.TXT"
                               ORGANIZATION IS LINE SEQUENTIAL.

       DATA DIVISION.
       FILE SECTION.
       FD INPUT-FILE.
       01 EMPLOYEE-RECORD.
          05 EMPLOYEE-ID       PIC X(10).
          05 FIRST-NAME        PIC X(20).
          05 LAST-NAME         PIC X(20).
          05 SALARY            PIC 9(6)V99.
          05 DEPARTMENT        PIC X(20).

       FD OUTPUT-FILE.
       01 REPORT-RECORD.
          05 HEADING-1         PIC X(40) VALUE "EMPLOYEE SALARY REPORT".
          05 FILLER            PIC X(3) VALUE SPACES.
          05 HEADING-2         PIC X(30) VALUE "DEPARTMENT WISE".
          05 HEADING-3         PIC X(30) VALUE "----------------------".
          05 FILLER            PIC X(3) VALUE SPACES.
          05 HEADING-4         PIC X(30) VALUE "EMPLOYEE ID".
          05 FILLER            PIC X(3) VALUE SPACES.
          05 HEADING-5         PIC X(30) VALUE "EMPLOYEE NAME".
          05 FILLER            PIC X(3) VALUE SPACES.
          05 HEADING-6         PIC X(30) VALUE "DEPARTMENT".
          05 FILLER            PIC X(3) VALUE SPACES.
          05 HEADING-7         PIC X(30) VALUE "SALARY".
          05 FILLER            PIC X(3) VALUE SPACES.
          05 TOTAL-SALARY      PIC 9(7)V99.

       WORKING-STORAGE SECTION.
       01 DEPARTMENT-TOTALS.
          05 TOTAL-ENGINEERING PIC 9(7)V99 VALUE 0.
          05 TOTAL-ACCOUNTING PIC 9(7)V99 VALUE 0.
          05 TOTAL-HR PIC 9(7)V99 VALUE 0.
          05 TOTAL-SALES PIC 9(7)V99 VALUE 0.
          05 TOTAL-ADMIN PIC 9(7)V99 VALUE 0.

       01 EOF-SWITCH.
          05 EOF-FLAG PIC X VALUE 'N'.

       PROCEDURE DIVISION.
       100-MAIN.
           OPEN INPUT INPUT-FILE
                OUTPUT OUTPUT-FILE.

       200-READ.
           READ INPUT-FILE
               AT END MOVE 'Y' TO EOF-FLAG.

       300-CALCULATE.
           IF EOF-FLAG = 'N'
               PERFORM 400-CHECK-DEPARTMENT
               PERFORM 600-UPDATE-DEPARTMENT-TOTALS
               PERFORM 200-READ
           ELSE
               CLOSE INPUT-FILE
                     OUTPUT-FILE.

       400-CHECK-DEPARTMENT.
           IF DEPARTMENT = 'ENGINEERING'
               ADD SALARY TO TOTAL-ENGINEERING
           ELSE IF DEPARTMENT = 'ACCOUNTING'
               ADD SALARY TO TOTAL-ACCOUNTING
           ELSE IF DEPARTMENT = 'HR'
               ADD SALARY TO TOTAL-HR
           ELSE IF DEPARTMENT = 'SALES'
               ADD SALARY TO TOTAL-SALES
           ELSE IF DEPARTMENT = 'ADMIN'
               ADD SALARY TO TOTAL-ADMIN.

       600-UPDATE-DEPARTMENT-TOTALS.
           MOVE TOTAL-ENGINEERING TO REPORT-RECORD-TOTAL-SALARY
           WRITE REPORT-RECORD
           MOVE TOTAL-ACCOUNTING TO REPORT-RECORD-TOTAL-SALARY
           WRITE REPORT-RECORD
           MOVE TOTAL-HR TO REPORT-RECORD-TOTAL-SALARY
           WRITE REPORT-RECORD
           MOVE TOTAL-SALES TO REPORT-RECORD-TOTAL-SALARY
           WRITE REPORT-RECORD
           MOVE TOTAL-ADMIN TO REPORT-RECORD-TOTAL-SALARY
           WRITE REPORT-RECORD.

       END PROGRAM CALC-SALARY.