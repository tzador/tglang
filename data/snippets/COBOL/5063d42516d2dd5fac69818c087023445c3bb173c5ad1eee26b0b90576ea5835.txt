IDENTIFICATION DIVISION.
       PROGRAM-ID. MYPROGRAM.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
          FILE-CONTROL.
             SELECT STUDENT-FILE ASSIGN TO 'STUDENT.TXT'
                ORGANIZATION IS LINE SEQUENTIAL.
          SELECT OUTPUT-FILE ASSIGN TO 'OUTPUT.TXT'
                ORGANIZATION IS LINE SEQUENTIAL.
       DATA DIVISION.
       FILE SECTION.
       FD STUDENT-FILE.
       01 STUDENT-RECORD.
          05 STUDENT-ID PIC X(5).
          05 STUDENT-NAME PIC X(20).
          05 STUDENT-SCORE1 PIC 9(3).
          05 STUDENT-SCORE2 PIC 9(3).
          05 STUDENT-SCORE3 PIC 9(3).
       FD OUTPUT-FILE.
       01 OUTPUT-RECORD.
          05 STUDENT-ID PIC X(5).
          05 TOTAL-SCORE PIC 9(4).
          05 AVERAGE SCORE PIC 9(3)V9(2).
       WORKING-STORAGE SECTION.
       01 TOTAL-SCORE PIC 9(4).
       01 STUDENT-COUNTER PIC 9(2) VALUE ZERO.
       PROCEDURE DIVISION.
       OPEN INPUT STUDENT-FILE
           OUTPUT OUTPUT-FILE.
       READ STUDENT-FILE
           AT END
               PERFORM CALCULATE-AVERAGE
               GO TO END-OF-FILE.
       CALCULATE-AVERAGE.
           COMPUTE TOTAL-SCORE = STUDENT-SCORE1 + STUDENT-SCORE2 + STUDENT-SCORE3.
           COMPUTE AVERAGE-SCORE = TOTAL-SCORE / 3.
           MOVE STUDENT-ID TO OUTPUT-RECORD-STUDENT-ID.
           MOVE TOTAL-SCORE TO OUTPUT-RECORD-TOTAL-SCORE.
           MOVE AVERAGE-SCORE TO OUTPUT-RECORD-AVERAGE-SCORE.
           WRITE OUTPUT-RECORD.
           ADD 1 TO STUDENT-COUNTER.
       READ STUDENT-FILE.
           AT END
               GO TO END-OF-FILE.
           NOT AT END
               PERFORM CALCULATE-AVERAGE.
       END-OF-FILE.
       CLOSE STUDENT-FILE
           OUTPUT-FILE.
       STOP RUN.