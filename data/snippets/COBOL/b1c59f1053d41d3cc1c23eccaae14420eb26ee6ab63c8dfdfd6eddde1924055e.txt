IDENTIFICATION DIVISION.
       PROGRAM-ID. CALCULATE-PAYROLL.
      ****************************************
      * This program calculates payroll for  *
      * employees based on their hours worked *
      * and hourly rate.                      *
      ****************************************
      ENVIRONMENT DIVISION.
      INPUT-OUTPUT SECTION.
      FILE-CONTROL.
          SELECT EMPLOYEE-FILE ASSIGN TO 'EMPLOYEES.DAT'
              ORGANIZATION IS LINE SEQUENTIAL.
          SELECT PAYROLL-FILE ASSIGN TO 'PAYROLL.DAT'
              ORGANIZATION IS LINE SEQUENTIAL.
      DATA DIVISION.
      FILE SECTION.
      FD EMPLOYEE-FILE.
      01 EMPLOYEE-RECORD.
          05 EMPLOYEE-ID       PIC X(5).
          05 EMPLOYEE-NAME     PIC X(25).
          05 HOURLY-RATE       PIC 9(5)V99.
          05 HOURS-WORKED      PIC 999V99.
          05 GROSS-PAY         PIC 9(6)V99.
      FD PAYROLL-FILE.
      01 PAYROLL-RECORD.
          05 EMPLOYEE-ID       PIC X(5).
          05 EMPLOYEE-NAME     PIC X(25).
          05 GROSS-PAY         PIC 9(6)V99.
      WORKING-STORAGE SECTION.
      01 TOTAL-GROSS-PAY       PIC 9(6)V99.
      01 TOTAL-HOURS-WORKED    PIC 999V99.
      PROCEDURE DIVISION.
      PERFORM CALCULATE-PAYROLL-HEADER
      PERFORM READ-EMPLOYEE-FILE
      PERFORM OUTPUT-EMPLOYEE-HEADER
      PERFORM CALCULATE-PAYROLL
      PERFORM WRITE-PAYROLL-RECORD
      PERFORM READ-EMPLOYEE-FILE UNTIL EOF-EMPLOYEE-FILE
      PERFORM OUTPUT-TOTALS
      PERFORM CLOSE-FILES
      STOP RUN.

      READ-EMPLOYEE-FILE.
          OPEN INPUT EMPLOYEE-FILE.
          READ EMPLOYEE-FILE
      AT END SET EOF-EMPLOYEE-FILE TO TRUE
          NOT AT END PERFORM CALCULATE-PAYROLL-RECORD
          END-READ.

      OUTPUT-EMPLOYEE-HEADER.
          DISPLAY 'Employee ID  Employee Name          Gross Pay'.

      CALCULATE-PAYROLL.
          MULTIPLY HOURLY-RATE BY HOURS-WORKED GIVING GROSS-PAY.

      OUTPUT-TOTALS.
          DISPLAY 'Total Hours Worked: ' TOTAL-HOURS-WORKED.
          DISPLAY 'Total Gross Pay: ' TOTAL-GROSS-PAY.

      CLOSE-FILES.
          CLOSE EMPLOYEE-FILE, PAYROLL-FILE.

      CALCULATE-PAYROLL-HEADER.
          DISPLAY '****** CALCULATING PAYROLL ******'.

      WRITE-PAYROLL-RECORD.
          WRITE PAYROLL-RECORD FROM EMPLOYEE-RECORD.

      CALCULATE-PAYROLL-RECORD.
          ADD HOURS-WORKED TO TOTAL-HOURS-WORKED.
          ADD GROSS-PAY TO TOTAL-GROSS-PAY.
          ADD 1 TO EMPLOYEE-COUNT.
      END PROGRAM CALCULATE-PAYROLL.