IDENTIFICATION DIVISION.
PROGRAM-ID. EXAMPLE.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO 'IN-FILE'.
    SELECT OUTPUT-FILE ASSIGN TO 'OUT-FILE'.

DATA DIVISION.
FILE SECTION.
FD INPUT-FILE.
01 DATA-RECORD.
    05 STUDENT-NAME         PIC X(20).
    05 STUDENT-ID           PIC 9(9).
    05 COURSE-NAME          PIC X(20).
    05 COURSE-SEMESTER      PIC 99.
    05 COURSE-GRADE         PIC X(2).
FD OUTPUT-FILE.
01 REPORT-LINE            PIC X(80).

WORKING-STORAGE SECTION.
01 NUM-STUDENTS           PIC 99.
01 TOTAL-GRADES.
    05 GRADE-A             PIC 99.
    05 GRADE-B             PIC 99.
    05 GRADE-C             PIC 99.

PROCEDURE DIVISION.
BEGIN.
    OPEN INPUT INPUT-FILE OUTPUT OUTPUT-FILE.
    READ INPUT-FILE INTO DATA-RECORD.
    PERFORM UNTIL NUM-STUDENTS > 50 
        ADD 1 TO NUM-STUDENTS.
        MOVE STUDENT-NAME TO REPORT-LINE(1:20).
        MOVE STUDENT-ID TO REPORT-LINE(21:9).
        MOVE COURSE-NAME TO REPORT-LINE(31:20).
        MOVE COURSE-SEMESTER TO REPORT-LINE(51:2).
        MOVE COURSE-GRADE TO REPORT-LINE(61:2).
        WRITE REPORT-LINE.
        PERFORM VARYING COURSE-GRADE FROM 1 BY 1 UNTIL COURSE-GRADE > 50
            IF COURSE-GRADE >= 90
                ADD 1 TO GRADE-A
            ELSE IF COURSE-GRADE >= 80
                ADD 1 TO GRADE-B
            ELSE
                ADD 1 TO GRADE-C
            END-IF.
        END-PERFORM.
        READ INPUT-FILE INTO DATA-RECORD.
    END-PERFORM.
    MOVE GRADE-A TO TOTAL-GRADES.
    WRITE "Number of students with an A grade: " GRADE-A.
    WRITE "Number of students with a B grade: " GRADE-B.
    WRITE "Number of students with a C grade: " GRADE-C.
    CLOSE INPUT-FILE OUTPUT-FILE.
    STOP RUN.
END PROGRAM EXAMPLE.