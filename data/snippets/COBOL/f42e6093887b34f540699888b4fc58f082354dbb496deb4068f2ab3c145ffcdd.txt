IDENTIFICATION DIVISION.
       PROGRAM-ID. SAMPLEPRG.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INFILE ASSIGN TO 'INPUTFILE.TXT'
               ORGANIZATION IS LINE SEQUENTIAL.
           SELECT OUTFILE ASSIGN TO 'OUTPUTFILE.TXT'
               ORGANIZATION IS LINE SEQUENTIAL.

       DATA DIVISION.
       FILE SECTION.
       FD INFILE.
       01 INPUT-RECORD.
           05 IN-FIELD-1 PIC A(10).
           05 IN-FIELD-2 PIC 9(5).
           05 IN-FIELD-3 PIC X(20).
       FD OUTFILE.
       01 OUTPUT-RECORD.
           05 OUT-FIELD-1 PIC X(20).
           05 OUT-FIELD-2 PIC 9(4).
           05 OUT-FIELD-3 PIC X(10).

       WORKING-STORAGE SECTION.
       01 TEMP-VAR PIC X(10).
       01 COUNTER PIC 9(3).

       PROCEDURE DIVISION.
       000-MAIN.
           OPEN INPUT INFILE.
           OPEN OUTPUT OUTFILE.
           PERFORM UNTIL EOF-FLAG = 'Y'
               READ INFILE
                   AT END MOVE 'Y' TO EOF-FLAG
               NOT AT END PERFORM 100-PROCESS-RECORD
           END-PERFORM.
           CLOSE INFILE.
           CLOSE OUTFILE.
           STOP RUN.

       100-PROCESS-RECORD.
           MOVE IN-FIELD-1 TO OUT-FIELD-1.
           MOVE IN-FIELD-2 TO OUT-FIELD-2.
           MOVE IN-FIELD-3 TO TEMP-VAR.
           PERFORM VARYING COUNTER FROM 1 BY 1 UNTIL COUNTER > 10
               IF COUNTER > 5 THEN
                   MOVE 'X' TO TEMP-VAR(COUNTER:1)
               ELSE
                   MOVE 'Y' TO TEMP-VAR(COUNTER:1)
               END-IF
           END-PERFORM.
           MOVE TEMP-VAR TO OUT-FIELD-3.
           WRITE OUTPUT-RECORD.