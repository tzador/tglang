****DATE EVALUATION PROGRAM****

IDENTIFICATION DIVISION.
PROGRAM-ID. DATE-EVAL.
AUTHOR. YOUR NAME.
DATE-WRITTEN. MM-DD-YYYY.
DATE-COMPILED.
REMARKS. THIS PROGRAM EVALUATES A GIVEN DATE AND DETERMINES WHETHER IT IS A VALID DATE.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
SELECT INPUT-FILE ASSIGN TO "DATE.IN" ORGANIZATION IS LINE SEQUENTIAL.
SELECT OUTPUT-FILE ASSIGN TO "DATE.OUT" ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD INPUT-FILE.
01 INPUT-RECORD.
   05 INPUT-DATE PIC X(10).

SD OUTPUT-FILE.
01 OUTPUT-RECORD.
   05 OUTPUT-DATE PIC X(10).

WORKING-STORAGE SECTION.
01 DATE-VALID PIC X(3) VALUE "YES".
01 MM PIC 99.
01 DD PIC 99.
01 YYYY PIC 9999.

PROCEDURE DIVISION.
MAIN-LOGIC-SECTION.
   OPEN INPUT INPUT-FILE
   OPEN OUTPUT OUTPUT-FILE
   PERFORM UNTIL EOF
      READ INPUT-FILE
      EVALUATE TRUE
         INPUT-DATE = "02/29/2020" 
            MM = INPUT-DATE(1:2)
            DD = INPUT-DATE(4:5)
            YYYY = INPUT-DATE(7:10)
            PERFORM VALID-DATE
            IF DATE-VALID = "NO"
               MOVE "INVALID DATE" TO OUTPUT-DATE
            ELSE
               MOVE INPUT-DATE TO OUTPUT-DATE
            END-IF
         INPUT-DATE = "04/31/2020" 
            MM = INPUT-DATE(1:2)
            DD = INPUT-DATE(4:5)
            YYYY = INPUT-DATE(7:10)
            PERFORM VALID-DATE
            IF DATE-VALID = "NO"
               MOVE "INVALID DATE" TO OUTPUT-DATE
            ELSE
               MOVE INPUT-DATE TO OUTPUT-DATE
            END-IF
         OTHER
            MOVE INPUT-DATE TO OUTPUT-DATE
      END-EVALUATE
      WRITE OUTPUT-RECORD
   END-PERFORM
   CLOSE INPUT-FILE
   CLOSE OUTPUT-FILE
   STOP RUN.

VALID-DATE.
   EVALUATE TRUE
      MM >= 1 AND MM <= 12 
         WHEN MM IS 4, 6, 9, 11 
            IF DD > 30 THEN
               MOVE "NO" TO DATE-VALID
            END-IF
         WHEN MM IS 1, 3, 5, 7, 8, 10, 12 
            IF DD > 31 THEN
               MOVE "NO" TO DATE-VALID
            END-IF
         WHEN MM = 2 
            IF YYYY MOD 4 = 0 AND (YYYY MOD 100 <> 0 OR YYYY MOD 400 = 0) 
               IF DD > 29 THEN 
                  MOVE "NO" TO DATE-VALID
               END-IF
            ELSE 
               IF DD > 28 THEN 
                  MOVE "NO" TO DATE-VALID
               END-IF
            END-IF
      OTHER
         MOVE "NO" TO DATE-VALID
   END-EVALUATE.

EOF.
   MOVE "END OF FILE" TO OUTPUT-DATE.
   WRITE OUTPUT-RECORD.
![](The code snippet has been outputted.)