IDENTIFICATION DIVISION.
       PROGRAM-ID. SAMPLE.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT SALES-FILE
		   ASSIGN TO 'SALES.DAT'
		   ORGANIZATION IS INDEXED
		   ACCESS MODE IS RANDOM.
		   
       DATA DIVISION.
       FILE SECTION.
       FD SALES-FILE.
       01  SALES-RECORD.
           05  SALESDATE     PIC 9(8).
           05  CUSTOMERID    PIC X(4).
           05  ITEMID        PIC X(10).
           05  QUANTITY      PIC 9(3).
           05  UNITPRICE     PIC 9(5)V99.
           05  TOTALPRICE    PIC 9(8)V99.
           
       WORKING-STORAGE SECTION.
       77  SALES-COUNT      PIC 9(3) VALUE ZERO.
       77  ITEM-TOTAL       PIC 9(6)V99 VALUE ZERO.

       PROCEDURE DIVISION.
       MAIN-PARAGRAPH.
           OPEN INPUT SALES-FILE.
           READ SALES-FILE
               AT END
                   DISPLAY 'NO SALES RECORDS FOUND.'
                   GO TO END-OF-PROGRAM.
           PERFORM PROCESS-RECORD
               UNTIL SALES-FILE-STATUS = '99'.

       PROCESS-RECORD.
           ADD 1 TO SALES-COUNT.
           COMPUTE TOTALPRICE = QUANTITY * UNITPRICE.
           ADD TOTALPRICE TO ITEM-TOTAL.
           DISPLAY 'SALES RECORD ' SALESDATE ' FOR CUSTOMER ' CUSTOMERID ' ITEM ' ITEMID ' QUANTITY ' QUANTITY ' TOTAL PRICE ' TOTALPRICE.
           READ SALES-FILE
               AT END
                   DISPLAY 'END OF SALES RECORDS.'
                   
       END-OF-PROGRAM.
           CLOSE SALES-FILE.
           DISPLAY 'TOTAL SALES ' ITEM-TOTAL.
           STOP RUN.