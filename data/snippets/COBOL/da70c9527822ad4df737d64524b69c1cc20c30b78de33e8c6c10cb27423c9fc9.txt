******************************;
* This is a COBOL program that calculates the average of a set of numbers *
* and displays the result with proper formatting. *
******************************;

IDENTIFICATION DIVISION.
PROGRAM-ID. AVERAGE-PROGRAM.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 NUMBERS PIC 9(10) VALUE 0.
01 COUNT PIC 9(2) VALUE 0.
01 TOTAL PIC 9(10) VALUE 0.
01 AVERAGE PIC 9(10)V9(2).
01 INPUT-CHAR PIC X.

PROCEDURE DIVISION.
BEGIN.
DISPLAY "Enter the number of elements to be averaged: ".
ACCEPT INPUT-CHAR.
MOVE INPUT-CHAR TO COUNT.
PERFORM CALCULATE-AVERAGE.
DISPLAY "The average is: ", AVERAGE.
STOP RUN.

CALCULATE-AVERAGE.
PERFORM ACCEPT-NUMBERS UNTIL COUNT = 0.
COMPUTE AVERAGE = TOTAL / COUNT.

ACCEPT-NUMBERS.
DISPLAY "Enter a number: ".
ACCEPT INPUT-CHAR.
IF INPUT-CHAR = 'Q' OR 'q'
    DISPLAY "Quitting program..."
    EXIT PROGRAM.
ADD INPUT-CHAR TO TOTAL.
SUBTRACT 1 FROM COUNT.