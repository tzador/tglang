IDENTIFICATION DIVISION.
       PROGRAM-ID. SAMPLE-PROGRAM.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT SALES-FILE ASSIGN TO "SALES.DAT".

       DATA DIVISION.
       FILE SECTION.
       FD SALES-FILE.
       01 SALES-RECORD.
           05 SALES-DATE              PIC XX/XX/XXXX.
           05 SALES-AMOUNT            PIC 9(6)V99.
           05 SALES-CUSTOMER-ID       PIC X(10).

       WORKING-STORAGE SECTION.
       01 TOTAL-SALES-AMOUNT           PIC 9(8)V99 VALUE 0.
       01 MAX-SALE-AMOUNT              PIC 9(6)V99 VALUE 0.
       01 MIN-SALE-AMOUNT              PIC 9(6)V99 VALUE 999999.
       01 AVERAGE-SALE-AMOUNT          PIC 9(8)V99 VALUE 0.
       01 TOTAL-TRANSACTIONS           PIC 9999 VALUE 0.

       PROCEDURE DIVISION.
       OPEN SALES-FILE.
           IF (CHECK-SALES-FILE)
               DISPLAY "ERROR OPENING SALES FILE"
           END-IF.
       PERFORM UNTIL END-OF-FILE
           READ SALES-FILE
               AT END SET END-OF-FILE TO TRUE
           END-READ
           IF (NOT END-OF-FILE)
               ADD SALES-AMOUNT TO TOTAL-SALES-AMOUNT
               ADD 1 TO TOTAL-TRANSACTIONS
               IF (SALES-AMOUNT > MAX-SALE-AMOUNT)
                   MOVE SALES-AMOUNT TO MAX-SALE-AMOUNT
               END-IF
               IF (SALES-AMOUNT < MIN-SALE-AMOUNT)
                   MOVE SALES-AMOUNT TO MIN-SALE-AMOUNT
               END-IF
           END-IF
       END-PERFORM.
       COMPUTE AVERAGE-SALE-AMOUNT = TOTAL-SALES-AMOUNT / TOTAL-TRANSACTIONS.
       CLOSE SALES-FILE.

       DISPLAY "TOTAL SALES AMOUNT: " TOTAL-SALES-AMOUNT.
       DISPLAY "MAXIMUM SALE AMOUNT: " MAX-SALE-AMOUNT.
       DISPLAY "MINIMUM SALE AMOUNT: " MIN-SALE-AMOUNT.
       DISPLAY "AVERAGE SALE AMOUNT: " AVERAGE-SALE-AMOUNT.

       CHECK-SALES-FILE.
           SET END-OF-FILE TO FALSE.
           PERFORM UNTIL END-OF-FILE
               READ SALES-FILE NEXT
                   AT END SET END-OF-FILE TO TRUE
               END-READ
           END-PERFORM.
           IF (NOT END-OF-FILE)
               RETURN TRUE
           ELSE
               RETURN FALSE
           END-IF.

       END PROGRAM SAMPLE-PROGRAM.