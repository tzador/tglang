WORKING-STORAGE SECTION.

       01 WS-DATA-RECORD.
          05 WS-DATA-VALUE PIC X(20).
          05 WS-DATA-FLAG PIC X.
          05 WS-DATA-AMOUNT PIC 9(8)V99.


       PROCEDURE DIVISION.

       MAIN-PROCEDURE.
          OPEN INPUT "DATAFILE".

          PERFORM UNTIL WS-DATA-FLAG = 'N'.
             READ DATAFILE INTO WS-DATA-RECORD
                AT END MOVE 'N' TO WS-DATA-FLAG
                NOT AT END PROCESS-DATA-RECORD
             END-READ.

          CLOSE "DATAFILE".
          STOP RUN.

       PROCESS-DATA-RECORD.
          PERFORM VALIDATE-DATA-VALUE
          PERFORM CALCULATE-DATA-AMOUNT.

       VALIDATE-DATA-VALUE.
          IF WS-DATA-VALUE NOT NUMERIC
             PERFORM DISPLAY-INVALID-DATA
          END-IF.

       CALCULATE-DATA-AMOUNT.
          MULTIPLY WS-DATA-AMOUNT BY 1.08
             GIVING WS-TOTAL-AMOUNT.

          DISPLAY "Total amount after tax: " WS-TOTAL-AMOUNT.

       DISPLAY-INVALID-DATA.
          DISPLAY "Data value is not a valid number: " WS-DATA-VALUE.


       END MAIN-PROCEDURE.