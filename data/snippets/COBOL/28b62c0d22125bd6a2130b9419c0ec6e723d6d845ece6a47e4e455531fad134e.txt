IDENTIFICATION DIVISION.
       PROGRAM-ID. PAYROLL.

       DATA DIVISION.
       FILE-SECTION.
       FD EMPLOYEE-FILE
       LABEL RECORDS ARE STANDARD
       RECORD CONTAINS 64 CHARACTERS
       BLOCK CONTAINS 0 RECORDS
       DATA RECORD IS EMPLOYEE-RECORD.

       01 EMPLOYEE-RECORD.
          05 EMPLOYEE-ID        PIC X(10).
          05 EMPLOYEE-NAME      PIC X(20).
          05 EMPLOYEE-DEPARTMENT PIC X(10).
          05 EMPLOYEE-SALARY    PIC 9(9)V99.
          05 EMPLOYEE-HIREDATE  PIC X(10).
          05 EMPLOYEE-TENURE    PIC 9.
          05 EMPLOYEE-BONUS     PIC 9(5).

       WORKING-STORAGE SECTION.
       01 TOTAL-SALARY         PIC 9(9)V99.
       01 TOTAL-BONUS          PIC 9(5).
       01 BONUS-RATE           PIC 9(3).

       PROCEDURE DIVISION.
       OPEN INPUT EMPLOYEE-FILE
       PERFORM UNTIL FILE-STATUS = 'EOF'
          READ EMPLOYEE-FILE INTO EMPLOYEE-RECORD
          PERFORM CALCULATE-BONUS
       END-PERFORM.
       CLOSE EMPLOYEE-FILE
       DISPLAY 'TOTAL SALARY: ' TOTAL-SALARY
       DISPLAY 'TOTAL BONUS: ' TOTAL-BONUS
       STOP RUN.

       CALCULATE-BONUS.
          IF EMPLOYEE-DEPARTMENT = 'SALES'
             COMPUTE BONUS-RATE = 5
          ELSE IF EMPLOYEE-DEPARTMENT = 'MARKETING'
             COMPUTE BONUS-RATE = 3
          ELSE
             COMPUTE BONUS-RATE = 1
          END-IF
          COMPUTE EMPLOYEE-BONUS = (EMPLOYEE-SALARY * BONUS-RATE) / 100
          ADD EMPLOYEE-BONUS TO TOTAL-BONUS
          ADD EMPLOYEE-SALARY TO TOTAL-SALARY.