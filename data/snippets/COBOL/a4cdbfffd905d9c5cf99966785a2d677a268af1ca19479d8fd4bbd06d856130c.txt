IDENTIFICATION DIVISION.
      PROGRAM-ID. SAMPLE.

      ENVIRONMENT DIVISION.
      INPUT-OUTPUT SECTION.
      FILE-CONTROL.
              SELECT INPUT-FILE ASSIGN TO "SAMPLE.IN".
              SELECT OUTPUT-FILE ASSIGN TO "SAMPLE.OUT".

      DATA DIVISION.
      FILE SECTION.
      FD INPUT-FILE
              RECORDING MODE IS F.
      01 INPUT-RECORD.
              05 EMPLOYEE-ID           PIC X(5).
              05 EMPLOYEE-NAME         PIC X(20).
              05 EMPLOYEE-DEPARTMENT   PIC X(10).
      FD OUTPUT-FILE
              RECORDING MODE IS F.
      01 OUTPUT-RECORD               PIC X(50).

      WORKING-STORAGE SECTION.
      01 EMPLOYEE-TOTAL               PIC S9(10)V99.
      01 DEPARTMENT-TOTAL OCCURS 5 TIMES
              INDEXED BY DEPT-INDEX     PIC S9(4) COMP.
      02 DEPARTMENT-TOTAL-AMOUNT      PIC S9(10)V99 VALUE 0.

      PROCEDURE DIVISION.
      OPEN INPUT INPUT-FILE.
      READ INPUT-FILE
             AT END
                     GO TO END-INPUT.
      PERFORM PROCESS-INPUT-RECORD
              UNTIL EOF = 'Y'.
      MOVE "EMPLOYEE TOTAL:" TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.

      MOVE EMPLOYEE-TOTAL TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.

      PERFORM PROCESS-DEPARTMENT-TOTAL
              UNTIL DEPT-INDEX > 5.
      MOVE "DEPARTMENT TOTAL:" TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.

      MOVE DEPARTMENT-TOTAL(1) TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.
      MOVE DEPARTMENT-TOTAL(2) TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.
      MOVE DEPARTMENT-TOTAL(3) TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.
      MOVE DEPARTMENT-TOTAL(4) TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.
      MOVE DEPARTMENT-TOTAL(5) TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.

      CLOSE INPUT-FILE
              OUTPUT-FILE
              END-PROGRAM.

      PROCESS-INPUT-RECORD.
      COMPUTE EMPLOYEE-TOTAL = EMPLOYEE-TOTAL + INPUT-RECORD(1:10).
      IF EMPLOYEE-DEPARTMENT = "SALES"
              ADD INPUT-RECORD(1:10) TO DEPARTMENT-TOTAL(SALES).
      ELSE IF EMPLOYEE-DEPARTMENT = "MARKETING"
              ADD INPUT-RECORD(1:10) TO DEPARTMENT-TOTAL(MARKETING).
      ELSE IF EMPLOYEE-DEPARTMENT = "HUMAN RESOURCES"
              ADD INPUT-RECORD(1:10) TO DEPARTMENT-TOTAL(HR).
      ELSE IF EMPLOYEE-DEPARTMENT = "FINANCE"
              ADD INPUT-RECORD(1:10) TO DEPARTMENT-TOTAL(FINANCE).
      ELSE IF EMPLOYEE-DEPARTMENT = "IT"
              ADD INPUT-RECORD(1:10) TO DEPARTMENT-TOTAL(IT).

      PROCESS-DEPARTMENT-TOTAL.
      ADD DEPARTMENT-TOTAL-AMOUNT TO OUTPUT-RECORD
      WRITE OUTPUT-RECORD AFTER ADVANCING 1 LINES.
      ADD 1 TO DEPT-INDEX.

      END-INPUT.
      DISPLAY "END OF PROGRAM."

      END-PROGRAM.