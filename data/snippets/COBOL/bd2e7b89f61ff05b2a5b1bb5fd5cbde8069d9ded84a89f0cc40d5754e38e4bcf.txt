IDENTIFICATION DIVISION.
PROGRAM-ID. CALCULATE-PAYROLL.

****************************************
*      PROGRAM CALCULATES PAYROLL       *
****************************************

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
   SELECT INPUT-FILE ASSIGN TO 'input.dat'
   SELECT OUTPUT-FILE ASSIGN TO 'output.dat'.

DATA DIVISION.
FILE SECTION.
   FD INPUT-FILE.
   01 EMPLOYEE-RECORD.
      05 EMPLOYEE-ID       PIC X(10).
      05 EMPLOYEE-NAME     PIC X(25).
      05 HOURLY-RATE       PIC 9(4)V99.
      05 HOURS-WORKED      PIC 9(3).

   FD OUTPUT-FILE.
   01 PAYROLL-RECORD.
      05 EMPLOYEE-ID       PIC X(10).
      05 EMPLOYEE-NAME     PIC X(25).
      05 GROSS-PAY         PIC 9(6).
      05 TAXES             PIC 9(5).
      05 NET-PAY           PIC 9(6).

WORKING-STORAGE SECTION.
   01 TAX-RATE             PIC 9(2)V99 VALUE 0.2.
   01 MAX-HOURS            PIC 9(3)    VALUE 40.

PROCEDURE DIVISION.
MAIN-LOGIC.
   OPEN INPUT INPUT-FILE.
   OPEN OUTPUT OUTPUT-FILE.
   PERFORM UNTIL EOF(INPUT-FILE)
      READ INPUT-FILE
         AT END SET EOF-FLAG TO TRUE
      END-READ
      IF NOT EOF-FLAG
         MOVE EMPLOYEE-ID TO EMPLOYEE-RECORD
         MOVE EMPLOYEE-NAME TO EMPLOYEE-RECORD
         MOVE HOURLY-RATE TO EMPLOYEE-RECORD
         MOVE HOURS-WORKED TO EMPLOYEE-RECORD
         CALL CALCULATE-PAY
      END-IF
   END-PERFORM.

   CLOSE INPUT-FILE
   CLOSE OUTPUT-FILE
   STOP RUN.

CALCULATE-PAY.
   MULTIPLY HOURLY-RATE BY HOURS-WORKED GIVING GROSS-PAY
   MULTIPLY GROSS-PAY BY TAX-RATE GIVING TAXES
   SUBTRACT TAXES FROM GROSS-PAY GIVING NET-PAY
   WRITE PAYROLL-RECORD.

   DISPLAY 'Employee: ' EMPLOYEE-NAME
   DISPLAY 'Gross Pay: ' EMPLOYEE-NAME
   DISPLAY 'Taxes: ' TAXES
   DISPLAY 'Net Pay: ' NET-PAY.