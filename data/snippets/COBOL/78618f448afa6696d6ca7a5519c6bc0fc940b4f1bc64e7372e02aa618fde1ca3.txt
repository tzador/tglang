IDENTIFICATION DIVISION.
PROGRAM-ID. GROCERY-PRICING.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 ITEM-COUNT PIC 99 VALUE 0.
01 ITEM-PRICES.
    05 PRICE-TABLE.
        10 FILLER PIC 9(2) VALUE 30.
        10 FILLER PIC 9(2) VALUE 20.
        10 FILLER PIC 9(2) VALUE 25.
        10 FILLER pic 9(2) value 15.
    05 item-price pic 9(2).
01 AVERAGE-PRICE PIC 9(2)V9999.
01 TOTAL PIC 9(5)V9999.
01 NAMES.
    05 NAME-1 PIC X(10) VALUE "BREAD".
    05 NAME-2 PIC X(10) VALUE "MILK".
    05 NAME-3 PIC X(10) VALUE "EGGS".
    05 NAME-4 PIC X(10) VALUE "CHEESE".

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM CALCULATE-PRICES THRU CALC-AVERAGE.
    DISPLAY "The average price of all items is $", AVERAGE-PRICE.
STOP RUN.

CALCULATE-PRICES.
    PERFORM VARYING ITEM-COUNT FROM 1 BY 1
        UNTIL ITEM-COUNT > 4
        COMPUTE ITEM-PRICES(ITEM-COUNT) = ITEM-COUNT * 5 + 10
        DISPLAY "The price of " NAMES(ITEM-COUNT) " is $", ITEM-PRICES(ITEM-COUNT) " and the total is $" ITEM-PRICES(ITEM-COUNT)
    END-PERFORM.

CALC-AVERAGE.
    PERFORM VARYING ITEM-COUNT FROM 1 BY 1
        UNTIL ITEM-COUNT > 4
        COMPUTE TOTAL = ITEM-PRICES(ITEM-COUNT) + TOTAL
    END-PERFORM.
    COMPUTE AVERAGE-PRICE = TOTAL / ITEM-COUNT.