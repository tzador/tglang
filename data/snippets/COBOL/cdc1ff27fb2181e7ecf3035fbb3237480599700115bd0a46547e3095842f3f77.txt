IDENTIFICATION DIVISION.
PROGRAM-ID. CALCULATE-TOTALS.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 READ-COUNT PICTURE 999.             * Variable to store number of records read from file
01 TOTAL-PRICE PICTURE 9(7)V99.        * Variable to store total price of all items
01 TOTAL-DISCOUNT PICTURE 9(5)V99.     * Variable to store total discount amount
01 TOTAL-TAX PICTURE 9(5)V99.          * Variable to store total tax amount
01 GRAND-TOTAL PICTURE 9(7)V99.        * Variable to store grand total of all items after discount and tax
01 ITEM-TABLE OCCURS 10 TIMES.         * Table to store item details
    03 ITEM-CODE PIC X(5).             * 5 character item code
    03 ITEM-PRICE PICTURE 9(5)V99.     * 5-digit item price with two decimal places
    03 ITEM-DISCOUNT PICTURE 9(3)V99.  * 3-digit item discount percentage with two decimal places
    03 ITEM-TAX PICTURE 9(3)V99.       * 3-digit item tax percentage with two decimal places
    03 ITEM-TOTAL PICTURE 9(7)V99.     * 7-digit item total price after discount and tax

PROCEDURE DIVISION.
    OPEN INPUT ITEM-FILE.
    READ ITEM-FILE AT END
        MOVE 'NO DATA FOUND' TO ERROR-MSG
        DISPLAY ERROR-MSG
        STOP RUN.
    DISPLAY 'READING ITEMS...'
    PERFORM READ-LOOP UNTIL READ-COUNT = 10.  * Read up to 10 records from file
    CLOSE ITEM-FILE.
    PERFORM CALCULATE-TOTALS.
    DISPLAY 'TOTAL PRICE: ' TOTAL-PRICE.
    DISPLAY 'TOTAL DISCOUNT: ' TOTAL-DISCOUNT.
    DISPLAY 'TOTAL TAX: ' TOTAL-TAX.
    DISPLAY 'GRAND TOTAL: ' GRAND-TOTAL.

READ-LOOP.
    READ ITEM-FILE AT END
        EXIT.
    ADD 1 TO READ-COUNT.
    MOVE ITEM-CODE TO ITEM-ARRAY(READ-COUNT).
    ADD ITEM-PRICE TO TOTAL-PRICE.
    MULTIPLY ITEM-PRICE BY ITEM-DISCOUNT GIVING TOTAL-DISCOUNT.
    DIVIDE TOTAL-DISCOUNT BY 100 GIVING TOTAL-DISCOUNT.
    ADD ITEM-TAX TO TOTAL-TAX.
    MULTIPLY ITEM-PRICE BY ITEM-TAX GIVING TOTAL-TAX.
    DIVIDE TOTAL-TAX BY 100 GIVING TOTAL-TAX.
    ADD ITEM-TOTAL TO GRAND-TOTAL.

CALCULATE-TOTALS.
    COMPUTE GRAND-TOTAL = TOTAL-PRICE + TOTAL-TAX - TOTAL-DISCOUNT.
    PERFORM SORT-ITEMS.
    PERFORM PRINT-REPORT.

SORT-ITEMS.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > READ-COUNT
        PERFORM VARYING J FROM 1 BY 1 UNTIL J > READ-COUNT - I
            IF ITEM-TABLE(J).ITEM-CODE > ITEM-TABLE(J+1).ITEM-CODE
                MOVE ITEM-TABLE(J) TO TEMP-ITEM.
                MOVE ITEM-TABLE(J+1) TO ITEM-TABLE(J).
                MOVE TEMP-ITEM TO ITEM-TABLE(J+1).

PRINT-REPORT.
    DISPLAY '---------------ITEM REPORT---------------'.
    DISPLAY 'ITEM CODE' ' ' 'ITEM PRICE' ' ' 'ITEM DISCOUNT' ' ' 'ITEM TAX' ' ' 'ITEM TOTAL'.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > READ-COUNT
        DISPLAY ITEM-TABLE(I).ITEM-CODE ' ' ITEM-TABLE(I).ITEM-PRICE ' ' ITEM-TABLE(I).ITEM-DISCOUNT ' ' ITEM-TABLE(I).ITEM-TAX ' ' ITEM-TABLE(I).ITEM-TOTAL.