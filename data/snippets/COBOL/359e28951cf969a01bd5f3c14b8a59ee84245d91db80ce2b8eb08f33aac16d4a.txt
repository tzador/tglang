IDENTIFICATION DIVISION.
       PROGRAM-ID. PROG001.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       SELECT VERSION FILE-001
       ASSIGN TO 'FILE001.DAT'
       ORGANIZATION IS INDEXED
       ACCESS MODE IS RANDOM.
       SELECT FILE-002 ASSIGN TO 'FILE002.TXT'.
       DATA DIVISION.
       FILE SECTION.
       FD FILE-001
       LABEL RECORDS ARE STANDARD
       RECORDING MODE IS F
       RECORD CONTAINS 80 CHARACTERS
       BLOCK CONTAINS 100 RECORDS.

       01 FILE-001-REC.
       05 FILE-001-NAME PIC X(20).
       05 FILE-001-AGE PIC 99.
       05 FILE-001-SALARY PIC 9(7)V99.

       FD FILE-002
       LABEL RECORDS ARE STANDARD
       RECORDING MODE IS F
       RECORD CONTAINS 80 CHARACTERS
       BLOCK CONTAINS 100 RECORDS.

       01 FILE-002-REC.
       05 FILLER PIC X(40).
       05 FILE-002-NAME PIC X(20).
       05 FILE-002-CODE PIC X.
       05 FILE-002-QTY PIC 9(3).

       WORKING-STORAGE SECTION.
       01 EOF SWITCH PIC X VALUE 'N'.
       01 INDEX PIC S9(7) COMP VALUE 0.
       01 PARTIAL-KEY PIC X(4) VALUE SPACES.
       PROCEDURE DIVISION.
       PERFORM UNTIL EOF SWITCH = 'Y'
           DISPLAY 'ENTER NAME TO SEARCH:'
           ACCEPT PARTIAL-KEY
           WRITE FILE-001-REC FROM PARTIAL-KEY
           INVALID KEY
               DISPLAY 'NO MATCH'
           END-INVALID
           PERFORM VARYING INDEX FROM 1 BY 1
               UNTIL EOF SWITCH = 'Y'
               READ FILE-002 INTO FILE-002-REC
                   IF FILE-002-NAME = FILE-001-NAME
                       ADD FILE-002-QTY TO INDEX
                   END-IF
                   AT END
                       SET EOF SWITCH TO 'Y'
                   END-READ
               END-PERFORM
           END-PERFORM.
       CLOSE FILE-001.
       CLOSE FILE-002.
       STOP RUN.