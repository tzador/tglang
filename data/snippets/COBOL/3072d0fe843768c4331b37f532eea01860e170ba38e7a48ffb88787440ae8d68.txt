01  SALES-AMOUNT-INPUT.
           05  SALES-TABLE OCCURS 6 TIMES.
                10  SALES-AMOUNT  PIC 9(7)V99.

       01  SALES-AMOUNT-OUTPUT.
           05  SALES-TABLE OCCURS 6 TIMES.
                10  SALES-AMOUNT  PIC 9(7)V99.

       01  TOTAL-AMOUNT-INPUT PIC 9(10)V99.

       01  TOTAL-AMOUNT-OUTPUT PIC 9(10)V99.

       01  MULTIPLICATION-TABLE.
           05  SALES-TABLE OCCURS 6 TIMES INDEXED BY SALES-INDEX.
                10  MULTIPLICATION-FIELD REDEFINES
                         SALES-TABLE(SALES-INDEX).
                     15  MULTIPLICATION PIC 9(7)V99.
                     15  TOTAL-AMOUNT-INT PIC 9(10).

       01  MULTIPLICATION-RESULTS-TABLE.
           05  MULTIPLICATION-TABLE OCCURS 6 TIMES INDEXED BY MULTI-INDEX.
                10  MULTIPLICATION-RESULT-FIELD REDEFINES
                         MULTIPLICATION-TABLE(MULTI-INDEX).
                     15  MULTIPLICATION-RESULT PIC 9(12)V99.

       PROCEDURE DIVISION.
       MAIN-PROGRAM.
           PERFORM CALCULATE-SALES-AMOUNTS
           PERFORM CALCULATE-TOTAL-AMOUNT
           PERFORM CALCULATE-MULTIPLICATION-TABLE
           PERFORM DISPLAY-RESULTS
           STOP RUN.

       CALCULATE-SALES-AMOUNTS.
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 6
               COMPUTE SALES-TABLE(I) = SALES-AMOUNT-INPUT(I)
           END-PERFORM.

       CALCULATE-TOTAL-AMOUNT.
           COMPUTE TOTAL-AMOUNT-OUTPUT = TOTAL-AMOUNT-INPUT.

       CALCULATE-MULTIPLICATION-TABLE.
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 6
               SET MULTI-INDEX TO I
               PERFORM VARYING J FROM 1 BY 1 UNTIL J > 6
                   SET SALES-INDEX TO J
                   COMPUTE MULTIPLICATION-FIELD = MULTIPLICATION *
                         SALES-AMOUNT-INPUT(SALES-INDEX)
                   SET MULTIPLY-INDEX TO J
               END-PERFORM.

       DISPLAY-RESULTS.
           DISPLAY "SALES AMOUNTS:"
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 6
               DISPLAY SALES-AMOUNT-OUTPUT(I)
           END-PERFORM
           DISPLAY "TOTAL AMOUNT:"
           DISPLAY TOTAL-AMOUNT-OUTPUT
           DISPLAY "MULTIPLICATION RESULTS:"
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 6
               DISPLAY MULTIPLICATION-RESULT
               SET MULTI-INDEX TO I
           END-PERFORM.