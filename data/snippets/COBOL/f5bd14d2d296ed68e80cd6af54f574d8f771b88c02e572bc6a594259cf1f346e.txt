IDENTIFICATION DIVISION.
PROGRAM-ID. CALCULATE-SALARY.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
SELECT SALES-FILE ASSIGN TO "SALES.DAT"
ORGANIZATION IS LINE SEQUENTIAL.
SELECT INVENTORY-FILE ASSIGN TO "INVENTORY.DAT"
ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD SALES-FILE
RECORDING MODE IS F.
01 SALES-RECORD.
05 SALESMAN-ID PIC 9(5).
05 MONTH PIC 99.
05 YEAR PIC 9999.
05 ITEMS PIC 9(3).

FD INVENTORY-FILE
RECORDING MODE IS F.
01 INVENTORY-RECORD.
05 ITEM-CODE PIC 9(5).
05 ITEM-DESCRIPTION PIC A(30).
05 UNIT-PRICE PIC 9(5).
05 QUANTITY-ON-HAND PIC 9(3).

WORKING-STORAGE SECTION.
01 SALES-AMOUNT PIC 9(5)V99.
01 TOTAL-SALES PIC 9(10)V99.
01 TOTAL-COST PIC 9(10)V99.
01 TOTAL-PROFIT PIC 9(10)V99.
01 ITEM-PROFIT PIC 9(5)V99.
01 AVERAGE-PROFIT PIC 9(4)V99.

PROCEDURE DIVISION.
OPEN INPUT SALES-FILE, INVENTORY-FILE.
READ SALES-FILE AT END GO TO END-OF-FILE.
PERFORM UNTIL END-OF-FILE = 'NO'
READ INVENTORY-FILE AT END GO TO END-OF-FILE.
MULTIPLY UNIT-PRICE BY QUANTITY-ON-HAND GIVING TOTAL-COST.
MULTIPLY UNIT-PRICE BY ITEMS GIVING SALES-AMOUNT.
SUBTRACT TOTAL-COST FROM SALES-AMOUNT GIVING ITEM-PROFIT.
ADD ITEM-PROFIT TO TOTAL-PROFIT.
ADD 1 TO ITEMS.
ADD ITEM-PROFIT TO TOTAL-PROFIT.
COMPUTE AVERAGE-PROFIT = TOTAL-PROFIT / ITEMS.
DISPLAY "Total sales: " TOTAL-SALES.
DISPLAY "Total profit: " TOTAL-PROFIT.
DISPLAY "Average profit per item: " AVERAGE-PROFIT.
READ SALES-FILE AT END GO TO END-OF-FILE.
END-PERFORM.

END-OF-FILE.
DISPLAY "End of program."
CLOSE SALES-FILE, INVENTORY-FILE.
STOP RUN.