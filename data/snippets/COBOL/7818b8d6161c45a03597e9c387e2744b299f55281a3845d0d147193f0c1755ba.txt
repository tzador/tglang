IDENTIFICATION DIVISION.
       PROGRAM-ID. CALCULATION.
      * Program to perform complex mathematical calculations.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       DATA DIVISION.
       FILE SECTION.
       FD INPUT-FILE.
       01 INPUT-RECORD.
          05 A PIC S9(4)V9(2).
          05 B PIC S9(4)V9(2).
          05 OPERATOR PIC X.
       WORKING-STORAGE SECTION.
       01 RESULT PIC S9(8)V9(4).
       01 OPERAND-A PIC S9(4)V9(2).
       01 OPERAND-B PIC S9(4)V9(2).
       01 CALCULATION-EQUALS PIC X(40) VALUE "THE RESULT OF THE CALCULATION IS ".
      * Initialize result to 0.
       PROCEDURE DIVISION.
          MOVE 0 TO RESULT.
      * Read input file and perform calculations.
       READ INPUT-FILE AT END DISPLAY CALCULATION-EQUALS
           "INPUT FILE IS EMPTY" END-READ
       PERFORM UNTIL EXIT = TRUE
         MOVE A TO OPERAND-A
         MOVE B TO OPERAND-B
         EVALUATE OPERATOR
           WHEN "+" ADD OPERAND-A, OPERAND-B GIVING RESULT
           WHEN "-" SUBTRACT OPERAND-B FROM OPERAND-A GIVING RESULT
           WHEN "*" MULTIPLY OPERAND-A BY OPERAND-B GIVING RESULT
           WHEN "/" DIVIDE OPERAND-A BY OPERAND-B GIVING RESULT
           WHEN "EXP" COMPUTE RESULT = OPERAND-A ** OPERAND-B
           WHEN OTHER DISPLAY "INVALID OPERATOR" END-EVALUATE
         ADD 1 TO COUNTER
       WRITE RESULT
       READ INPUT-FILE AT END DISPLAY CALCULATION-EQUALS
            "CALCULATED " COUNTER " RESULTS" END-READ
       END-PERFORM.
       STOP RUN.