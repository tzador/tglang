IDENTIFICATION DIVISION.
       PROGRAM-ID. MY-PROGRAM.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INPUT-FILE ASSIGN TO "input.txt".
           SELECT OUTPUT-FILE ASSIGN TO "output.txt".

       DATA DIVISION.
       FILE SECTION.
       FD INPUT-FILE.
       01 INPUT-RECORD.
           05 INPUT-NAME          PIC X(20).
           05 INPUT-AGE           PIC 99.
           05 INPUT-GENDER        PIC X.

       FD OUTPUT-FILE.
       01 OUTPUT-RECORD.
           05 OUTPUT-NAME         PIC X(20).
           05 OUTPUT-AGE          PIC 99.
           05 OUTPUT-GENDER       PIC X.
           05 OUTPUT-AGE-RANGE    PIC X.

       WORKING-STORAGE SECTION.
       01 TOTAL-MALE-AGE         PIC 99.
       01 TOTAL-FEMALE-AGE       PIC 99.
       01 TOTAL-RECORDS          PIC 99.

       PROCEDURE DIVISION.
       PERFORM READ-RECORD UNTIL INPUT-RECORD = "   ".

       READ-RECORD.
           READ INPUT-FILE INTO INPUT-RECORD
               AT END MOVE "END" TO INPUT-RECORD.

           IF INPUT-GENDER = "M"
               ADD INPUT-AGE TO TOTAL-MALE-AGE
           ELSE IF INPUT-GENDER = "F"
               ADD INPUT-AGE TO TOTAL-FEMALE-AGE.
       
       PERFORM CALCULATE-AVERAGE.
       PERFORM WRITE-RECORD UNTIL INPUT-RECORD = "END".

       CALCULATE-AVERAGE.
           COMPUTE TOTAL-AGE = TOTAL-MALE-AGE + TOTAL-FEMALE-AGE
           DIVIDE TOTAL-AGE BY TOTAL-RECORDS GIVING AVERAGE-AGE.

       WRITE-RECORD.
           MOVE INPUT-NAME TO OUTPUT-NAME.
           MOVE INPUT-AGE TO OUTPUT-AGE.
           MOVE INPUT-GENDER TO OUTPUT-GENDER.
           IF INPUT-AGE < 18
               MOVE "Minor" TO OUTPUT-AGE-RANGE
           ELSE IF INPUT-AGE >= 18 AND INPUT-AGE < 60
               MOVE "Adult" TO OUTPUT-AGE-RANGE
           ELSE
               MOVE "Senior" TO OUTPUT-AGE-RANGE.
           WRITE OUTPUT-RECORD.

       STOP RUN.