IDENTIFICATION DIVISION. 
       PROGRAM-ID. COBOL-PROGRAM. 

       DATA DIVISION. 
       WORKING-STORAGE SECTION. 
       01 TAX-TABLE. 
          05 TAX-RATE PIC 99.99. 
          05 TAX-THRESHOLD PIC 99,999. 

       01 INCOME-TAX-RATE. 
          05 LOW-INCOME-TAX-RATE PIC 99.99. 
          05 MEDIUM-INCOME-TAX-RATE PIC 99.99. 
          05 HIGH-INCOME-TAX-RATE PIC 99.99. 

       01 INCOME-TABLE. 
          05 INCOME-TAX-THRESHOLD PIC 99,999. 
          05 INCOME-TAX-AMOUNT PIC 999,999. 

       PROCEDURE DIVISION. 
       MAIN-PROCEDURE. 
           MOVE 18.5 TO LOW-INCOME-TAX-RATE 
           MOVE 25.0 TO MEDIUM-INCOME-TAX-RATE 
           MOVE 30.0 TO HIGH-INCOME-TAX-RATE 

           PERFORM VARYING INCOME-TAX-RATE FROM 0 BY 1 
               UNTIL INCOME-TAX-RATE > 100 
               IF INCOME-TAX-RATE > INCOME-TAX-THRESHOLD 
                   PERFORM CALCULATE-INCOME-TAX 
                        WITH INCOME-TAX-RATE 
                        AND INCOME-TAX-THRESHOLD 

       CALCULATE-INCOME-TAX. 
           SET TAX-RATE TO LOW-INCOME-TAX-RATE 
           IF INCOME-TAX-RATE > TAX-THRESHOLD 
               SET TAX-RATE TO MEDIUM-INCOME-TAX-RATE 
               IF INCOME-TAX-RATE > TAX-THRESHOLD 
                   SET TAX-RATE TO HIGH-INCOME-TAX-RATE 

           PERFORM VARYING INCOME-TABLE FROM 0 BY 1 
               UNTIL INCOME-TABLE-THRESHOLD > INCOME-TAX-RATE 
               IF INCOME-TABLE-THRESHOLD = INCOME-TAX-RATE 
                   DISPLAY "Income tax rate is " TAX-RATE 
                   DISPLAY "Calculation threshold is " INCOME-TAX-THRESHOLD 
                   DISPLAY "Income tax due is " INCOME-TAX-AMOUNT 
               ELSE 
                   CONTINUE 
           END-PERFORM. 

       END-PROGRAM COBOL-PROGRAM.