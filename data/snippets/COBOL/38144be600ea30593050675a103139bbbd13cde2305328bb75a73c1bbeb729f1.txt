IDENTIFICATION DIVISION.
PROGRAM-ID. SAMPLE-PROGRAM.
DATA DIVISION.
FILE SECTION.
FD INPUT-FILE.
01 RECORD-IN.
05 EMPLOYEE-NAME PIC X(30).
05 EMPLOYEE-ID PIC 9(6).
05 DEPARTMENT PIC X(10).
WORKING-STORAGE SECTION.
01 TOTAL-SALARY PIC 9(7)V99.
01 AVERAGE-SALARY PIC 9(8)V99.
PROCEDURE DIVISION.
MAIN-LOGIC.
OPEN INPUT INPUT-FILE.
PERFORM UNTIL RECORD-IN = 'END'.
IF DEPARTMENT = 'SALES'.
MULTIPLY EMPLOYEE-ID BY 0.05 GIVING SALES-BONUS.
MOVE EMPLOYEE-NAME TO NAMES-IN-SALES.
ELSE IF DEPARTMENT = 'MARKETING'.
MULTIPLY EMPLOYEE-ID BY 0.1 GIVING MARKETING-BONUS.
MOVE EMPLOYEE-NAME TO NAMES-IN-MARKETING.
END-IF.
ADD EMPLOYEE-ID TO TOTAL-SALARY.
EXEC SQL
SELECT AVG(EMPLOYEES.SALARY) INTO :AVERAGE-SALARY
FROM EMPLOYEES
WHERE DEPARTMENT = 'SALES'
AND EMPLOYEE-NAME = :NAMES-IN-SALES.
DISPLAY 'Average salary for sales employees is ' AVERAGE-SALARY.
PERFORM PRINT-OUTPUT.
END-PERFORM.
CLOSE INPUT-FILE.
STOP RUN.
PROCEDURE DIVISION.
PRINT-OUTPUT.
DISPLAY 'Total salary is ' TOTAL-SALARY.
DISPLAY 'Sales bonus for ' NAMES-IN-SALES ' is ' SALES-BONUS.
DISPLAY 'Marketing bonus for ' NAMES-IN-MARKETING ' is ' MARKETING-BONUS.
DISPLAY 'New total salary is ' TOTAL-SALARY + SALES-BONUS + MARKETING-BONUS.
STOP RUN.