; This program will automatically open Notepad and type out a phrase followed by the date and time
#SingleInstance, force ; Ensures only one instance of the script is running at a time
#NoEnv ; Disables the use of environment variables
#Warn ; Displays warnings for syntax and potential errors
SetWorkingDir %A_ScriptDir% ; Sets the working directory to the same folder as the script

; Declare variables
phrase := "Hello, world!" ; The phrase to be typed out
format := "MM/dd/yyyy HH:mm:ss" ; The date and time format to be used
currentDateTime := A_Now ; Get the current date and time

; Format the current date and time using the specified format
formattedDateTime := FormatTime(currentDateTime, format)

; Open Notepad
Run, notepad.exe

; Wait for Notepad window to become active
WinWaitActive, Untitled - Notepad, , 3

; Type out the phrase followed by the formatted date and time
Send, %phrase% - %formattedDateTime%

; Save the file with the current date and time as the filename
fileName := "Autogenerated-" . formattedDateTime . ".txt" ; Concatenates strings to create the filename
Send ^s ; Sends Ctrl+S command to save the file
Send %fileName% ; Types out the filename
Send {Enter} ; Sends Enter key to confirm save

; Close Notepad
WinClose, Untitled - Notepad ; Closes the Notepad window

; Display a message indicating the completion of the task
MsgBox, Text entered and saved successfully. ; Displays a message box with the specified text

ExitApp ; Exits the script