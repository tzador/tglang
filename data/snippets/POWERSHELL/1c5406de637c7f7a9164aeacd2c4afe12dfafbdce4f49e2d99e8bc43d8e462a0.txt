Get-Process | Where-Object {$_.Name -eq "notepad.exe"} | Select-Object -ExpandProperty Threads | ForEach-Object {$_.WaitForExit(1000)} | Export-Csv -Path "C:\Users\User1\Documents\notepad_thread_status.csv"