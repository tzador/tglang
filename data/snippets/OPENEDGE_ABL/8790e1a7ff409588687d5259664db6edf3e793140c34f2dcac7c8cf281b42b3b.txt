DEFINE VARIABLE cYear AS CHARACTER NO-UNDO.
DEFINE VARIABLE cMonth AS CHARACTER NO-UNDO.
DEFINE VARIABLE cDay AS CHARACTER NO-UNDO.
DEFINE VARIABLE cDate AS CHARACTER NO-UNDO.
DEFINE VARIABLE nDate AS DECIMAL NO-UNDO.
 
DEFINE FRAME frmDatePicker
    BUTTON btnSet LABEL "Set" SIDE-LABELS NO-UNDERLINE
    WITH 14 DOWN, 45 LEFT, 
         3 ROWS.
DEFINE FRAME frmCalendar
    BUTTON btnPrevMonth LABEL "<" SIDE-LABELS NO-UNDERLINE
    BUTTON btnNextMonth LABEL ">" SIDE-LABELS NO-UNDERLINE
    WITH 14 DOWN, 3 LEFT,
         3 ROWS.
 
ON ERROR UNDO, THROW.
 
DEFINE BUTTON btnSet TRIGGERS SET-DATE().
 
FUNCTION SET-DATE.
    IF cYear = ? THEN cYear = STRING(ENTRY(3)).
    IF cYear = ? THEN cYear = STRING(CURRENT-DATE, "9999").
    IF cMonth = ? THEN cMonth = STRING(ENTRY(2)).
    IF cMonth = ? THEN cMonth = STRING(CURRENT-DATE, "99").
    IF cDay = ? THEN cDay = STRING(ENTRY(1)).
    IF cDay = ? THEN cDay = STRING(CURRENT-DATE, "99").
    ASSIGN cDate = cYear + cMonth + cDay.
    ASSIGN nDate = DECIMAL(cDate).
    ASSIGN THIS-VALUE = STRING(nDate, "99/99/9999").
    MESSAGE "The selected date is:" THIS-VALUE
        VIEW-AS ALERT-BOX INFO BUTTONS OK.
 
UPDATE FRAME frmCalendar SUBMIT CHANGES SET cDay cMonth cYear WITH FRAME-HANDLE(hDatePicker).
 
ENABLE ALL WITH FRAME frmCalendar.
 
WAIT-FOR CHOOSE OF btnSet IN FRAME frmCalendar.
 
ENABLE FRAME frmDatePicker RESIZE, TEXT chMonth TO 3, COLUMN chMonth 10, INT chMonth NOWRAP, WIDTH chMonth AUTO.