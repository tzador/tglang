USING OpenEdge.Core.*.
USING OpenEdge.Data.*.
USING OpenEdge.Serialization.*.
   
CLASS Employee:
  DEFINE PUBLIC PROPERTY Id AS INT.
  DEFINE PUBLIC PROPERTY Name AS CHARACTER.
  DEFINE PUBLIC PROPERTY Age AS INT.
END CLASS.

DEFINE VARIABLE cTable AS CHARACTER NO-UNDO.
DEFINE VARIABLE hTable AS HANDLE NO-UNDO.

RUN OpenEdge.Data.Query ON "querystring.p" PERSISTENT SET hQuery.
RUN hQuery:

  DEFINE BOOL SET-SIZE        = TRUE.
  DEFINE BOOL REBUILD-INDICES = TRUE.

  ADD-NEW-LANGUAGE (LANGUAGE) VALUE ("English").
  ADD-NEW-LANGUAGE (LANGUAGE) VALUE ("Spanish").
  ADD-NEW-LANGUAGE (LANGUAGE) VALUE ("French").

  hLanguage = NEW AddNewLanguage ().

  DEFINE INPUT PARAMETER pLang AS CHARACTER.

  FOR EACH Employee WHERE Employee.LANGUAGE = pLang:

    REPEAT:
      ADD-NEW-LANGUAGE (LANGUAGE) VALUE ("German").
    END