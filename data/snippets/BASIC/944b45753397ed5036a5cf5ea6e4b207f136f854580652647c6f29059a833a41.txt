# SUB-ROUTINE FOR SORTING AN ARRAY
SUB SORT(ARRAY, LOWER, UPPER)
    # CHECK IF ARRAY IS EMPTY
    IF LOWER >= UPPER THEN
        EXIT SUB

    # CHOOSE A PIVOT ELEMENT
    PIVOT = ARRAY(UPPER)

    # PARTITION THE ARRAY
    I = LOWER - 1
    J = UPPER + 1
    WHILE TRUE DO
        WHILE ARRAY(I) < PIVOT DO
            I = I + 1
        END WHILE

        WHILE ARRAY(J) > PIVOT DO
            J = J - 1
        END WHILE

        IF I >= J THEN
            EXIT WHILE
        END IF

        # SWAP ELEMENTS
        TEMP = ARRAY(I)
        ARRAY(I) = ARRAY(J)
        ARRAY(J) = TEMP
    END WHILE

    # RECURSIVELY SORT LEFT AND RIGHT SUB-ARRAYS
    CALL SORT(ARRAY, LOWER, J)
    CALL SORT(ARRAY, J + 1, UPPER)
END SUB

# DEFINE AN ARRAY TO BE SORTED
DIM NUMBERS(10)
NUMBERS(0) = 8
NUMBERS(1) = 1
NUMBERS(2) = 5
NUMBERS(3) = 3
NUMBERS(4) = 10
NUMBERS(5) = 2
NUMBERS(6) = 6
NUMBERS(7) = 9
NUMBERS(8) = 4
NUMBERS(9) = 7

# CALL SUB-ROUTINE FOR SORTING
CALL SORT(NUMBERS, 0, 9)

# PRINT SORTED ARRAY
FOR I = 0 TO 9
    PRINT NUMBERS(I)
NEXT I