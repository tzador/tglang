REPORT Z_DEMO.

* Table Declaration
TABLES: LT_SFLIGHT.

* Variables Declaration
DATA: LV_FLDATE TYPE SFLIGHT-FLDATE.
DATA: LV_DSTNATION TYPE SFLIGHT-DSTNATION,
      LV_STATIONFROM TYPE SFLIGHT-STATIONFROM.

* Inner Join Query
SELECT * FROM SFLIGHT
  INTO LT_SFLIGHT
  WHERE FLDATE = LV_FLDATE
    AND DSTNATION = LV_DSTNATION
    AND STATIONFROM = LV_STATIONFROM.

* Looping through the table
LOOP AT LT_SFLIGHT INTO SFLIGHT.
  * Checking for valid dates
  IF SFLIGHT-FLDATE < SY-DATUM.
    WRITE: / 'Flight Date is in the past'.
  ELSE.
    DATA: LV_DURATION TYPE SFLIGHT-DURATION.
    * Calculating the duration of the flight
    LV_DURATION = SFLIGHT-DEPTIME - SFLIGHT-ARRTIME.
    WRITE: / 'The flight duration is', LV_DURATION, 'hours'.
  ENDIF.
ENDLOOP.