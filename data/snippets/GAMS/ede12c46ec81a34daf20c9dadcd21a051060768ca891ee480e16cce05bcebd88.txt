Set i 'index for nodes in the graph';
alias(i,j);
Parameter cost(i,j) 'cost of edge from node i to node j';
Parameter flow(i,j) 'flow of commodity on edge from node i to node j';
Variable supply(i) 'supply of commodity at node i';
Variable demand(i) 'demand of commodity at node j';
Variable obj 'objective function value';
Equation balance(i) 'flow balance at node i';
    obj = sum((i,j), cost(i,j)*flow(i,j));
    balance(i)$(supply(i) <> 0 or demand(i) <> 0).. supply(i) - demand(i) =e= sum(j, flow(i,j) - flow(j,i));
    Model graph /all/;
    solve graph using lp maximizing obj;