Процедура ЗаполнитьТаблицу(ТаблицаДанные, ФорматЛинии, АдресаСервера, ИмяПользователя, Пароль)
	
	Если ТаблицаДанные.Колонки.Количество >= 3 Тогда
	/* Создаем соединение с сервером */
            Соединение = СоздатьОбъект("СоединениеПользователя", АдресаСервера, ИмяПользователя, Пароль);
	// Подключаемся к базе данных
            БазаДанных = Соединение.Подключиться();
	// Получаем таблицу данных из базы данных
            Запрос = Новый Запрос;
            Запрос.УстановитьПараметр("Таблица", ТаблицаДанные);
            Запрос.УстановитьПараметр("ФорматЛинии", ФорматЛинии);
            Результат = Запрос.Выполнить(БазаДанных);
            ТаблицаДанные = Результат.Выбрать();
            Пока ТаблицаДанные.Следующий() Цикл
	// Форматируем линию данных в соответствии с заданным форматом
                ФорматированнаяЛиния = СтроковаяФорматирование(ФорматЛинии, ТаблицаДанные.Колонки.Найти("Поле1").Значение, ТаблицаДанные.Колонки.Найти("Поле2").Значение, ТаблицаДанные.Колонки.Найти("Поле3").Значение);
	// Добавляем отформатированную линию в таблицу данных
                ТаблицаДанные.Добавить(ТаблицаДанные.Колонки.Количество + 1, ФорматированнаяЛиния);
            КонецЦикла;
        Иначе
	// Выводим сообщение об ошибке, если количество колонок в таблице данных меньше 3
            Сообщить("Количество колонок в таблице данных должно быть не менее 3");
        КонецЕсли;
    КонецПроцедуры
	
	// Пример вызова процедуры
	ЗаполнитьТаблицу(ТаблицаДанные, "Поле1:%s, Поле2:%s, Поле3:%s", "АдресСервера", "ИмяПользователя", "Пароль");