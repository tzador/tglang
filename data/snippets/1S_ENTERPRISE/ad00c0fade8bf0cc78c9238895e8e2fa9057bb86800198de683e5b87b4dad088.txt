// This is a comment in 1C_ENTERPRISE

#Использовать "Безопасные Окно";
#Использовать "Константы";

Процедура СозданиеИНакопительнойТаблицы()
    // создаем объект типа НакопительнаяТаблица
    НоваяНакопительнаяТаблица = Новый НакопительнаяТаблица;
    
    // зададим название НакопительнойТаблицы
    НоваяНакопительнаяТаблица.Наименование = "ТаблицаНакоплений";
    
    // получаем количество строк в таблице
    КоличествоСтрок = НоваяНакопительнаяТаблица.Количество();
    
    // создаем массивы для хранения данных
    МассивЗначений = Новый Массив;
    МассивКлючей = Новый Массив;
    
    // в цикле заполняем массивы данными о накоплениях
    Для Каждого СтрокаНакопления Из НоваяНакопительнаяТаблица Цикл
        // получаем значение накопления
        Значение = СтрокаНакопления.Накопление;
        
        // получаем ключ (год) назначения накопления
        Ключ = СтрокаНакопления.ПолучитьГодНакопления();
        
        // добавляем значение и ключ в соответствующие массивы
        МассивЗначений.Добавить(Значение);
        МассивКлючей.Добавить(Ключ);
    КонецЦикла;
    
    // задаем значения массивов в качестве свойств НакопительнойТаблицы
    НоваяНакопительнаяТаблица.Значения = МассивЗначений;
    НоваяНакопительнаяТаблица.Ключи = МассивКлючей;
    
    // возвращаем созданную НакопительнуюТаблицу
    Возврат НоваяНакопительнаяТаблица;
КонецПроцедуры