// Define variables
ПериодНачала = '01.01.2019';
ПериодОкончания = '31.12.2019';
ТаблицаДанных = Новый ТаблицаЗначений;

// Loop through the period
Период = НачалоНедели(ПериодНачала);
Пока Период <= ПериодОкончания Цикл

    // Select data from database
    Запрос = Новый Запрос;
    Запрос.Текст = "ВЫБРАТЬ
                    |ИДЕНТИФИКАТОР,
                    |НАЗВАНИЕ,
                    |РАСХОДНЫЕ,
                    |ПРИХОДНЫЕ
                    |ИЗ Материалы
                    |ГДЕ
                    |    ЗАКРЫТ = ЛОЖЬ
                    |И
                    |    ДАТА <= &Период";

    // Set query parameter for the current period
    ПараметрыЗапроса = Запрос.Параметры;
    ПараметрыЗапроса.Вставить("Период", Период);

    // Execute the query and add data to the table
    ТаблицаЗапроса = Запрос.Выполнить().Выгрузить();
    ТаблицаДанных.ДобавитьСтроки(ТаблицаЗапроса);

    // Move to the next week
    Период = СледующаяНеделя(Период);
КонецЦикла;

// Sort the table by the material ID in descending order
ТаблицаДанных.Сортировать('ИДЕНТИФИКАТОР', ВозврВозрСтроки.Убыв);

// Export the table to a CSV file
Экспорт.ЭкспортироватьТаблицуДанных(ТаблицаДанных, "C:\РезультатЗапроса.csv");