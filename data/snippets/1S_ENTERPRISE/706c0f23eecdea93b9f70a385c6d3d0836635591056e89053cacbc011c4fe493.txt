Функция ВыполнитьЗапрос(НаборЗаписей, Колонки)
	
	// Функция для выполнения запроса к набору записей и выбора указанных колонок
	
	// Параметры:
	// НаборЗаписей - набор записей, к которому будет выполнен запрос
	// Колонки - массив с названиями колонок, которые нужно выбрать
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ " + СтроковыеФункции.Соединить(Колонки, ",") + " ИЗ " + НаборЗаписей.Name;
	
	// Добавляем условие на выборку записей
	УсловиеВыборки = Новый Условие;
	УсловиеВыборки.Текст = "КонецПоиска = Ложь";
	Запрос.УсловияВыборки.Добавить(УсловиеВыборки);
	
	// Добавляем группировку по первому столбцу
	// Чтобы выбрать по одной записи из каждой группы
	Группировка = Новый Группировка(Колонки[0]);
	Запрос.Группировки.Добавить(Группировка);
	
	// Устанавливаем режим кеширования запроса
	Запрос.Кешировать = Истина;
	
	// Выполняем запрос
	Выборка = Запрос.Выполнить().Выбрать();
	
	// Возвращаем результат в виде массива записей
	Результат = [];
	Пока Выборка.Следующий() Цикл
		Запись = Новый Массив;
		
		// Добавляем данные каждой колонки в запись
		Для Каждого Колонка Из Колонки Цикл
			Запись.Добавить(Выборка.Получить(Колонка));
		КонецЦикла;
		
		Результат.Добавить(Запись);
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции