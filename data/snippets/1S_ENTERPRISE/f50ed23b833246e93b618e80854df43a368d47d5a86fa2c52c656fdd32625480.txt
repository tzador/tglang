#Запрос - создает запрос на выборку данных из документа "Поступление товаров"
СоздатьЗапрос=Функция(ЭтотОбъект)
    #Задаем строку запроса
    СтрокаЗапроса = "ВЫБРАТЬ
        ТОВАРЫ.Код КАК КодТовара,
        ТОВАРЫ.Название КАК Название,
        ТОВАРЫ.Цена КАК Цена
    ИЗ
        Документ.ПоступлениеТоваров КАК Док
        ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НаличиеТоваров КАК ТОВАРЫ
        ПО Док.Номер = ТОВАРЫ.НомерДокумента
    ГДЕ
        Док.Дата <= &Дата
    УПОРЯДОЧИТЬ ПО
        Док.Дата УБЫВ
    ";

    #Заполняем параметры запроса
    Запрос = Новый Запрос(СтрокаЗапроса);
    Запрос.УстановитьПараметр("Дата", ЭтотОбъект.Дата);

    #Выполняем запрос и получаем результат
    Результат = Запрос.Выполнить().Выбрать();

    #Создаем таблицу для вывода информации
    ТаблицаЗапроса = Новый ТаблицаЗначений;
    ТаблицаЗапроса.Колонки.Добавить("КодТовара");
    ТаблицаЗапроса.Колонки.Добавить("Название");
    ТаблицаЗапроса.Колонки.Добавить("Цена");

    #Цикл для перебора результатов запроса и заполнения таблицы
    Пока Результат.Следующий() Цикл
        ТаблицаЗапроса.Добавить();
        ТаблицаЗапроса.ТекущаяСтрока["КодТовара"] = Результат.КодТовара;
        ТаблицаЗапроса.ТекущаяСтрока["Название"] = Результат.Название;
        ТаблицаЗапроса.ТекущаяСтрока["Цена"] = Результат.Цена;
    КонецЦикла;

    Возврат ТаблицаЗапроса;
КонецФункции