&НаСервере
Функция УправляемаяФункция(Знач СтрокаНаименование, Объекты = Неопределено, Знач Счет = Неопределено) Экспорт

    Перем Запрос, Результат, ТаблицаОбъектов;
    
    Запрос = Новый Запрос;
    Запрос.УстановитьПроизвольныйЗапрос(СоединениеСИнформационнойБазой, СтрокаНаименование);
    
    Если ТипЗнч(Объекты) = Тип("Массив") Тогда
    	Запрос.УстановитьПараметр("Объекты", Объекты);
    КонецЕсли;
    
    Если ЗначениеЗаполнено(Счет) Тогда
    	Запрос.УстановитьПараметр("Счет", Счет);
    КонецЕсли;
    
    Результат = Запрос.Выполнить();
    ТаблицаОбъектов = Результат.Выгрузить();
    
    Выход = ТаблицаОбъектов;
КонецФункции

Функция РасчетПоказателяРентабельности() Экспорт

    Перем Объекты, ИтогТаблица, ПоказательРентабельности, КодыСчетов;
    
    Объекты = ПолучитьСписокОбъектов();
    КодыСчетов = ПолучитьСписокКодовСчетов();
    
    ИтогТаблица = УправляемаяФункция("...Рент-НачисленияПоСчетам()", Объекты, КодыСчетов);
    
    Пока Объекты.Расположение() = "Следующий" Цикл
        ПоказательРентабельности = (Объекты.СтатьяДохода - Объекты.СтатьяРасхода) / Объекты.СтатьяДохода;
        
        ИтогТаблица.Добавить();
        ИтогТаблица.Последний();
        ИтогТаблица.ПоказательРентабельности = ПоказательРентабельности;
    КонецЦикла;
    
КонецФункции