#ОтображениеУвольнений
#Описание:
#Код формы отображения данных о сотрудниках, уволенных за последний месяц
#Эта форма предназначена для использования руководителями и кадровыми специалистами
#Автор: Иванова Мария

Форма ОтображениеУвольнений принимает значения выборки из БазыДанных "Сотрудники" за последний месяц

#Обработка события НачатьЗагрузку:

ОчиститьФорму();
ЗаголовокФормы = "Результаты отбора уволенных сотрудников";
#Код для показа всплывающего сообщения с текущей датой
Сообщить("Дата начала отчета: " + Функции.ТекущаяДата());
Сообщить("Дата окончания отчета: " + Функции.ТекущаяДата());
#Формирование запроса к базе данных
Запрос = Новый Запрос;
Запрос.Текст = "ВЫБРАТЬ
                    |     Сотрудники.ФИО КАК ФИО,
                    |     Сотрудники.Должность КАК Должность,
                    |     Сотрудники.Дата_увольнения КАК Дата_увольнения
                    |ИЗ
                    |     БазаДанных.Сотрудники КАК Сотрудники
                    |ГДЕ
                    |     Сотрудники.Дата_увольнения МЕЖДУ НАЧАЛОММЕСЯЦА(Функции.ТекущаяДата()) И КОНЕЦМЕСЯЦА(Функции.ТекущаяДата())";

#Выполнение запроса
РезультатЗапроса = Запрос.Выполнить();

#Заполнение таблицы результатами запроса
Результаты.ЗаголовкиКолонок = Новый Массив;
Результаты.ДобавитьЗаголовок("ФИО", "ФИО", 200);
Результаты.ДобавитьЗаголовок("Должность", "Должность", 200);
Результаты.ДобавитьЗаголовок("Дата увольнения", "Дата_увольнения", 200);
Результаты.Заполнить(РезультатЗапроса);

#Обработка события ЗавершитьЗагрузку:
#Проверка количества записей в результате запроса
Если Результаты.Количество = 0 Тогда
    #Если записей нет, то показываем соответствующее сообщение
    Сообщить("За указанный период увольнений не было");
КонецЕсли;