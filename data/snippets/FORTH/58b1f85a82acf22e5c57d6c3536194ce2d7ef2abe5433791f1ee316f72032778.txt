: BIN ( n -- s )
  0 "#" SWAP 0 DO
  2 /MOD 2 / 1 AND
  "#" APPEND
  LOOP 1 DROP
;
 
: BINARY-FIB ( n -- s )
  DUP 0
  <> IF
    1- DUP ['] BINARY-FIB >R
    SWAP 1- R> ['] BINARY-FIB +
  ELSE
    ( n = 0 or 1 )
    DROP 1
  THEN
  BIN
;
 
: ARRAY-EMAIL-CLASS ( str -- str )
  "ARRAY-EMAIL-CLASS " APPEND ." CLASS " SPACE
  SPACE 375 ROT ." " [CHAR]
  FOR I RANGE
  JTH APPEND . SPACE
  [CHAR] @
  TUCK ON
  [CHAR] (
  IUM APPEND
  ITH APPEND
  I = APPEND
  SCANNED OFF
  INITIALIZE E? L OPTIONM  " APPEND
 ;
 
: CLASSIFICATION-EMAIL-PREDICTION ( str -- str )
  RESET EMAIL-VECTOR EMAIL-ARRAY
  EMAIL-STR TUCK
  "LETTER-VECTOR" TUCK 1 APPEND
  EMAIL-ARRAY I J INDEX>, 12
  FOR I RANGE
  0 J RANGE
  I J INDEX>, 12
  FOR J RANGE
  I J INDEX>, INDEX>, INDEX>, INDEX>,
  INIT TUCK
  [CHAR] [
  I J INDEX>, INDEX>, INDEX>, INDEX>,
  INIT J ( S+ ).
  0 I= 66 AND
  DROP 20 OTHERWISE
  OR 1 APPEND
  VECTOR> CLASSIFY
  I J INDEX>, INDEX>, INDEX>, STDEV 0
  RESET BOOTSTRAP
  RAT+ ( 1 )
  STR 1 APPEND
  "EMAIL-ARRAY" APPEND
  "EMAIL-VECTORS" APPEND
  I J INDEX>, SPAN 1 SHAPE
  "CLASS " J RANGE
  I ARRAY-RESIZE APPLICATION 1 STDEV
  ?2
  BLERPROPGEN
  ST R> BINARY-FIB
  LOOP FOR [EMAIL FWD$ UNLABELED-EMAIL-STR [CHAR] & SEPARATOR-EMAIL], 10
  DIR. H THROW> [CYLINDER] TWISTER
  F:_ SHAPE
  ALL>Combined>foreground
  0-I +>;