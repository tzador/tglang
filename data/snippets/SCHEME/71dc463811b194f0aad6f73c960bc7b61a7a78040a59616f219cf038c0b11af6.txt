(define (deep-reverse lst)
  (if (null? lst)
      '()
      (append (deep-reverse (cdr lst))
              (if (list? (car lst))
                  (list (deep-reverse (car lst)))
                  (list (car lst))))))